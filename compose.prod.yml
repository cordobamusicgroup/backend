version: '3.3'
name: 'cmg-backend'

services:
  cmg-api-prod:
    build:
      context: .
      dockerfile: Dockerfile
    env_file:
      - .env.production
    ports:
      - '1000:6060'
    depends_on:
      - cmg-db-prod
      - cmg-redis-prod

  cmg-db-prod:
    image: 'postgres:latest'
    environment:
      - 'POSTGRES_DB=cmgapi'
      - 'POSTGRES_PASSWORD=localpassword'
      - 'POSTGRES_USER=cmgapi'
    ports:
      - '1001:5432'

  cmg-redis-prod:
    image: 'redis:latest'
    ports:
      - '1002:6379'
